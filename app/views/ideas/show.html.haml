%h1
  = @idea.title
  = button_tag name: "like_button_idea#{@idea.id}", class: "btn_like_idea btn pull-right" do
    %span.glyphicon.glyphicon-thumbs-up
    %span.like_count
      = @idea.like_count

%hr

- if @comments.present?
  .list-group
    - @comments.select(&:persisted?).each do |comment|
      .list-group-item
        - if comment.user.try(:image_url)
          = image_tag(comment.user.image_url, width: 30, height: 30, alt: comment.user.nickname, title: comment.user.nickname).html_safe
          = comment.body
        - else
          = comment.body

        = button_tag name: "like_button_comment#{@idea.id}_#{comment.id}", class: "btn_like_comment btn pull-right" do
          %span.glyphicon.glyphicon-thumbs-up
          %span.like_count
            = comment.like_count

- if logged_in?
  = form_for [@idea, @comment] do |f|
    - if @comment.errors.any?
      .alert.alert-danger
        %ul
          - @comment.errors.full_messages.each do |msg|
            %li
              = msg
    .form-group
      = f.text_area :body, class: 'form-control', placeholder: 'コメント'
    = f.submit 'コメントを送信する', class: 'btn btn-success'
- else
  %p
    コメントを追加するためには#{ link_to 'ログイン', '/auth/twitter' }が必要です。

